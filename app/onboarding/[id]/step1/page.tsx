"use client";

import { useEffect, useMemo, useState } from "react";
import { useParams, useRouter } from "next/navigation";
import { OnboardingState, statusToPath } from "@/lib/onboarding";
import Link from "next/link";
import Image from "next/image";

type Proposal = {
  id: string;
  title: string;
  description: string | null;
  image_urls: string[];
  created_at: string;
};

type RequestInfo = {
  step_status: OnboardingState;
};

export default function Step1SettlementPage() {
  const params = useParams<{ id: string }>();
  const rawId = params?.id;
  const id = Array.isArray(rawId) ? rawId[0] : rawId;
  const router = useRouter();

  const [info, setInfo] = useState<RequestInfo | null>(null);
  const [proposals, setProposals] = useState<Proposal[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [banner, setBanner] = useState<string | null>(null);
  const [preview, setPreview] = useState<string | null>(null);
  const [openTermIndex, setOpenTermIndex] = useState<number | null>(0);

  useEffect(() => {
    let mounted = true;
    (async () => {
      try {
        if (!id) throw new Error("유효하지 않은 경로입니다.");
        const res = await fetch(`/api/onboarding/${id}/step1`);
        const json = await res.json();
        if (!res.ok) throw new Error(json?.error || "불러오기 실패");
        if (!mounted) return;
        setInfo({ step_status: json.step_status });
        setProposals(json.proposals || []);
      } catch (e: any) {
        if (mounted) setError(e.message ?? "오류가 발생했습니다.");
      } finally {
        if (mounted) setLoading(false);
      }
    })();
    return () => {
      mounted = false;
    };
  }, [id]);

  const nextPath = `/onboarding/${id}/step2`;
  const showNext = true;

  const statusMessage = useMemo(() => {
    if (!info) return null;
    const s = info.step_status;
    if (s === "step3_proposed") return "정산안이 제안되어 승인 대기 중입니다.";
    if (s === "step3_approved") return "정산안이 승인되었습니다. 다음 단계로 진행하세요.";
    if (s === "step2_done") return "전화 안내가 완료되었습니다.\n담당자가 정산안을 업데이트하면 확인 및 승인 후 다음 단계에서 구장 상세 정보를 작성해주세요.";
    return "현재 상태에서 정산안을 확인할 수 있습니다.";
  }, [info]);

  const terms = useMemo(
    () => [
      {
        title: "구장 제휴 서비스 이용 약관",
        content: `**제 1 조 (목적)**
본 약관은 (주)마이플레이컴퍼니(이하 “회사”라 한다)가 스포츠 시설을 운영하는 자(이하 “구장 회원”이라 한다)의 스포츠 시설을 활용하여 각종 구장 제휴 서비스(이하 “구장 제휴 서비스”라 한다)를 제공하고 “구장 회원”에게 이에 따른 구장료 등을 원활히 지급하기 위해 “회사”와 “구장 회원” 간의 권리, 의무 및 책임사항 등 기타 필요한 사항을 규정하는 것을 목적으로 한다.

**제 2 조 (정의)**
본 약관에서 사용하는 용어의 정의는 다음과 같다.
1) “플랩 서비스” 또는 “서비스”란 “회사”가 PC용 웹사이트, 모바일용 어플리케이션 등을 통해 ”구장 회원” 및 “이용자”에게 제공하는 각종 제반 서비스를 말한다.
1) “이용자”란 “회사”와 서비스 이용계약을 체결하고 ”회사”가 제공하는 “플랩 서비스”를 이용하는 모든 사람, 단체 등의 일반 소비자를 말한다.
1) “스포츠 시설”은 다양한 스포츠 활동 또는 경기 따위를 할 수 있게 만든 장소, 기구 및 각종 부대시설, 부속시설을 포함한다.
1) “구장”은 “구장 회원”이 소유하거나 운영하고 있는 “스포츠 시설”을 말한다.
1) “구장 제휴 서비스"는 ”이용자”가 “구장 회원”의 “구장”을 원활히 이용할 수 있도록 중개하기 위하여 “회사”가 ”구장 회원” 및 “이용자”에게 제공하는 서비스로, “구장 예약 중개 서비스", “소셜 매치 진행 서비스", “레슨 서비스", “대회 서비스", “리그 서비스”를 포함한다.
1) “구장 예약 서비스"는 “이용자”가 “구장 회원”의 “구장”을 예약할 수 있도록 “회사"가 이를 중개하는 것을 말한다.
1) “소셜 매치 진행 서비스"는 “회사”가 “이용자”를 모집하여 “구장 회원”의 “구장”에서 운영 및 진행하는 스포츠 활동 및 경기를 말한다.
1) “레슨 서비스"는 “구장 회원"의 “구장”에서 진행되는 개인 및 단체 교습 성격의 스포츠 활동 및 경기를 말한다.
1) “대회 서비스”는 “구장 회원"의 “구장”에서 진행되는 개인 및 단체 대회 성격의 스포츠 활동 및 경기를 말한다.
1) “리그 서비스”는 “구장 회원"의 “구장”에서 진행되는 개인 및 단체 리그 성격의 스포츠 활동 및 경기를 말한다.
1) “구장 관리 사이트”는 “회사”가 “구장 회원”의 “구장”을 활용하여 “구장 제휴 서비스”를 제공하기 위해 ”구장 회원” 및 “이용자”가 이용하여야 하는 일정 관리 서비스를 말한다.
1) "플랩 매니저" 또는 “매니저”는 ”회사”의 "구장 제휴 서비스" 운영을 대행하는 운영자를 말한다.
1) "대기 매치"는 "소셜 매치 진행 서비스" 진행 준비를 위해 아직 "이용자"에게 공개되지 않은 일정의 매치를 말한다.
1) "공개 매치"는 "소셜 매치 진행 서비스" 진행이 예정되어 "이용자"에게 공개된 일정의 매치를 말한다.
1) “구장 예약 중개 서비스 수수료”는 “구장 회원”이 “구장 예약 서비스” 이용의 대가로 “회사”에 지급하는 금액으로 중개이용료, 결제정산수수료, 카드결제수수료 등을 포함한다.

**제 3 조 (서비스 이용 계약 기간)**
1) 본 약관에 따른 “회사”와 “구장 회원” 간 서비스 이용계약은 “구장 회원”이 본 약관에 동의한 날(이하 “약관 동의일”)에 효력이 발생하며 계약 기간은 약관 동의일부터 “약관 동의일”이 속한 연도의 다음 해 12월 31일까지로 한다.
1) 다만, 본 약관 동의 이전에 “회사”와 전자 방식의 제휴 계약서(이하 “기존 전자 계약서”)를 체결한 “구장 회원”의 경우, 본 약관의 적용 시점(효력 적용일) 은 다음 각 호에 따른다.
1) “기존 전자 계약서”의 종료일이 2025년 12월 31일 이하인 경우, 본 약관은 2026년 1월 1일부터 적용된다.
1) “기존 전자 계약서”의 종료일이 2026년 1월 1일 이후인 경우, 약관 동의일이 2026년 1월 1일 이전이면 본 약관은 2026년 1월 1일부터, 약관 동의일이 2026년 1월 1일 이후이면 약관 동의일부터 적용된다.
1) 본 조에서 말하는 “기존 전자 계약서”란, “구장 회원”이 본 약관 동의 이전에 “회사”와 체결한 모든 전자 방식의 제휴 계약서를 의미한다.
1) “구장 회원”이 서비스 이용 계약 기간 만료일로부터 30일 전까지 명시적인 서비스 중단 또는 회원 탈퇴의 의사를 밝히지 않을 경우, 서비스 이용 계약 기간은 자동으로 1년씩 연장된다.

**제 4 조 (“구장 회원”의 의무 및 책임)**
1) “구장 회원"은 자신이 소유 또는 운영하는 “구장” 및 “스포츠 시설” 중 “이용자"의 부상을 초래할 수 있는 구조물 및 시설물(인조 잔디, 골대, 그물 등을 포함하며 이에 한정되지 아니함)의 파손, 노후, 손상, 훼손을 방지하고 수리하여 안전성과 편의성을 유지할 의무 및 책임이 있다.
1) “구장 회원”은 “이용자"의 원활한 구장 이용을 위하여 조명, 구장 시설 개폐에 문제가 없도록 하여야 하고, 쓰레기 처리 및 구장의 청결 관리에 대한 의무 및 책임이 있다.
1) "구장 회원"은 기상 상황으로 인한 부상을 예방하고 시설 이용에 지장이 발생하지 않도록, 해빙, 제설, 배수, 낙상 방지 작업 등을 수행할 의무 및 책임이 있다.
1) ”구장 회원“은 ”이용자“에게 주차 안내 및 관련 문제 처리에 대한 지원을 제공할 의무 및 책임이 있다.
1) “구장 회원”은 “이용자”의 원활한 스포츠 활동 및 경기를 위하여, 어떠한 사유로든 구장 이용이 불가능한 경우, 그 사실을 “회사" 혹은 “이용자”에게 “스포츠 시설” 사용 최소 2시간 전까지 알릴 의무 및 책임이 있다.
1) “구장 회원”은 철저한 구장 예약 현황 파악 및 예약 관리를 통해 일정 누락, 중복 예약 등의 문제가 발생하지 않도록 해야 할 의무 및 책임이 있다.
1) “구장 회원”은 특별한 사유 없이 “회사”와 사전 협의한 구장 사용 일정을 임의로 변경할 수 없으며, 천재지변, 시설 사용 불가 등 불가피한 사유로 인해 구장 사용 일정 변경이 필요할 경우 최소 14일 전에 “회사”와의 사전 합의를 거쳐야 한다. 단, 구체적인 사용 일정 변경 절차는 “플랩풋볼 제휴 세부 정책”에 규정된 바에 따른다.
1) “구장 회원”은 “이용자”의 “구장” 사용에 따라 현장에서 발생하는 민원(소음, 도난, 시설 파손, 부상, 화재, 상해 등)에 대한 관리 의무 책임을 부담한다. 단, 해당 민원을 해결하기 위해 “회사”의 협력이 필요할 경우 “회사”는 이에 적극 협조한다.
1) “구장 회원”은 “구장” 등 시설물로 인해 발생하는 손해를 담보하기 위해 시설 보험 등에 가입하여야 하며, “이용자”가 “구장 회원”의 “구장”에서 서비스를 이용하는 과정에서 “구장” 또는 시설물로 인해 부상 등 손해를 입는 경우 “구장 회원”은 보험을 적용하여 “이용자”에게 발생한 손해를 배상하여야 한다. 단, 만일 보험에 가입하지 않은 경우 또는 “구장 회원”이 가입한 보험의 배상 범위에 포함되지 않으나 “구장 회원”의 시설물 관리책임이 존재하는 경우에는 “회사”가 “구장 회원”을 대신하여 “이용자”에게 발생한 손해를 배상할 수 있으며, “구장 회원”은 “회사”가 “이용자”에게 지급한 배상금에 해당하는 금액 및 이로 인해 “회사”가 입은 손해를 “회사”에 배상하여야 한다.
1) “구장 회원”은 “이용자”의 분실물이 있는 경우 자신의 책임으로 이를 보관하여야 하며, “이용자”의 분실물 관련 문의가 있는 경우 이에 성실히 대응하여야 한다.
1) “회사”는 “구장 회원”의 “구장” 및 “스포츠 시설”에 대해 “이용자”가 평가하는 구장 만족도 지표를 통해 “구장 회원”에게 본 조에 따른 “구장” 및 “스포츠 시설”의 추가 관리 등을 요구할 수 있으며, “구장 회원”은 이를 수행하기 현저히 어려운 부득이한 사정이 없는 한 “회사”의 요구에 응해야 한다.
1) 본 조에서 규정한 “구장 회원”의 의무 및 세부 기준은 “플랩풋볼 제휴 세부 정책”에서 구체적으로 정할 수 있으며, 이를 위반할 경우 “구장 회원”은 이로 인해 “회사”, “이용자” 및 제3자에게 발생한 손해를 배상하고 “회사”에 “플랩풋볼 제휴 세부 정책”에서 정한 위약벌을 지급해야 한다.

**제 5 조 (”구장 회원”의 확인 및 보증사항)**
1) “구장 회원”은 다음 각 호의 사항이 모두 사실과 정확히 일치함을 확인 및 보증하며, 이에 반하는 사실이 발견된 경우 본 약관 및 관계 법령에 따른 모든 법적책임을 부담한다.
1) “구장 회원”은 대한민국에 주소 또는 거소를 두고 있는 개인이거나, 적법하게 설립되어 유효하게 존속하는 대한민국의 법인이며, 사업자의 경우 적법한 사업자등록 절차를 마치거나 해외에 정식으로 등록하고 있다는 사실
1) “구장 회원”이 운영하는 자신의 “스포츠 시설” 및 “구장”의 상태 및 예약 일정, 예약 가능 여부 등에 대해 “회사” 및 “이용자”에게 공지한 내용 모두가 사실과 일치하는 정보이며 항상 최신 업데이트된 정보라는 사실
1) “구장 회원”이 본 약관을 통해 “회사”에게 제공하는 “스포츠 시설” 및 “구장” 등의 적법한 소유자 또는 운영할 수 있는 권리를 가진 자로서 이를 “회사” 및 “이용자”에게 대관 또는 이용하도록 하기 위해 취득하여야 하는 관계 법령상 인허가, 기타 계약상 권한 등 모든 적법한 자격을 갖춘 자라는 사실
1) “회사”는 제1항의 확인 및 보증사항을 검증하기 위하여 “구장 회원”에게 이와 관련된 증빙자료(사업자등록증, 법인등기부등본, 부동산 등기부등본, 각종 권리 확인을 위한 계약서 등을 포함하며 이에 한정되지 아니함)의 제출을 요구할 수 있고, 다음 각 호의 정보 제출을 요청하거나 공인인증기관 또는 신용정보회사 등을 통하여 확인할 수 있다.
1) 사업자인 “구장 회원”: 사업자의 성명(법인인 경우 대표자의 성명), 상호, 주소, 전화번호, 이메일주소, 신원정보, 신용도, 사업자등록번호, 기타 사업자 관련 정보 등
1) 사업자가 아닌 “구장 회원”: 성명, 생년월일, 주소, 전화번호, 이메일주소, 신원정보, 신용도 등
1) “구장 회원”은 제2항의 요청을 받은 즉시 지체 없이 “회사”에게 요청 받은 자료를 제공하여야 하며, 정당한 사유 없이 이를 거절한 경우 “회사”는 본 약관에 따른 서비스 이용계약을 해지하고 “구장 회원”은 즉시 회원 자격을 상실한다.
1) 제3항에 따라 본 약관에 따른 서비스 이용계약이 해지될 경우, “구장 회원”은 이를 이유로 회사에게 손해배상 등 어떠한 책임도 물을 수 없다.
1) “구장 회원”이 본 조에 따라 “회사”에게 제공한 정보가 변경(개인사업자가 법인사업자으로 변경되거나 그 반대의 경우를 포함하며 이에 한정되지 아니함)되거나 본 약관에 따른 의무 내용에 중대한 변경을 초래할 수 있는 사유가 발생한 경우 지체 없이 이메일 또는 서면으로 “회사”에 통보하여야 한다.
1) 본 조에서 규정한 “구장 회원”의 확인 및 보증사항은 “플랩풋볼 제휴 세부 정책”에서 구체적으로 정할 수 있으며, 이를 위반할 경우 “구장 회원”은 이로 인해 “회사”, “이용자” 및 제3자에게 발생한 손해를 배상하고 “회사”에 “플랩풋볼 제휴 세부 정책”에서 정한 위약벌을 지급해야 한다.

**제 6 조 (”구장 회원”의 금지행위)**
“구장 회원”은 다음 각 호에 해당하는 행위를 하여서는 아니 되며 이를 위반한 경우 “회사”는 본 약관에 따른 서비스의 정지, 손해배상 청구, 위약벌 청구 및 서비스 이용계약의 해제/해지 등의 조치를 취할 수 있다. 단, 이와 관련된 구체적인 기준 등에 대해서는 ”플랩풋볼 제휴 세부 정책” 등 관련 하위 정책에서 정한다.
1) 본 약관에서 규정된 “구장 회원”의 의무 사항을 위반하는 행위
1) 개인정보 침해, 영업비밀 침해, 지식재산권 및 초상권, 인격권을 침해하는 행위 등을 포함하여 “회사”의 약관 및 정책을 위반하는 행위
1) 범죄 행위와 결부되는 모든 행위 및 기타 관계 법령에 위반되는 행위
1) “회사” 서비스를 방해하거나 장애를 발생시킬 수 있는 모든 행위
1) 본 약관에 따른 권리∙의무를 “회사”의 사전 동의 없이 타인에게 양도, 증여하거나 이를 담보제공 하는 행위
1) 본 약관 또는 이에 부수되는 하위 정책 등을 위반하여 “회사” 또는 “이용자”나 제3자에게 손해를 발생시키거나 발생시킬 우려가 있는 행위

**제 7 조 (”구장 회원” 평가 시스템)**
1) “회사”는 “구장 회원”이 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 규정한 의무사항 준수 여부 및 그 정도를 평가하거나 “이용자”로 하여금 평가하도록 하는 시스템을 운영할 수 있다.
1) “회사”는 제1항에 따른 평가 결과를 제8조의 정산 금액 산정에 반영하거나 본 약관에 따른 서비스 이용계약을 해지 또는 해제할 수 있으며, “구장 관리 사이트”를 운영하는 알고리즘 또는 기타 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에 반영할 수 있다.
1) “회사”는 제1항의 평가 시스템에 관한 평가 방법과 기준, 이익 및 불이익에 대한 사항을 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 정할 수 있으며, 필요한 경우 평가 결과를 여러 가지 형태로 공개할 수 있다.

**제 8 조 (정산)**
1) “회사”는 “소셜 매치 진행 서비스”를 위해 사용한 구장료에 대해 ”플랩풋볼 제휴 세부 정책”에 따라 책정된 총 정산 금액을 “구장 회원”에게 지급한다.
1) “회사”는 “구장 예약 중개 서비스”를 통해 결제된 판매 확정 금액에서 ”플랩풋볼 제휴 세부 정책” 및 별도 합의에 따른 구장 예약 중개 서비스 수수료와 기타 결제 수수료를 공제한 정산 금액을 “구장 회원”에게 지급한다.
1) “회사”는 매월 1일에서 말일까지 “구장 제휴 서비스”를 통해 발생한 정산 금액에 대하여 익월 5일에 “구장 회원”에게 정산서를 발송한다. 단, 5일이 주말 혹은 휴일일 경우 전 영업일에 정산서를 발송하며, 1일부터 5일 내에 영업일이 없는 경우 다음 영업일에 정산서가 발송된다.
1) “구장 회원"은 “회사”에게 받은 정산서에 특별한 이의가 없을 경우 3영업일 내에 “소셜 매치 진행 서비스”의 정산 금액에 대해 “회사”에 세금계산서를 발행함으로써 입금을 요청하여야 하며, “회사”는 세금계산서 발급 3영업일 이내에 정산금을 지급한다.
1) “구장 회원”이 “회사”에게 받은 정산서에 특별한 이의를 제기하지 않을 경우 ”회사”는 정산서 발행일로부터 3 영업일 내에 “구장 예약 중개 서비스”의 구장 예약 중개 서비스 수수료에 해당하는 금액에 대해 “구장 회원”에게 세금계산서를 발행하고 세금계산서 발급 3영업일 내에 정산금을 지급한다.
1) “구장 회원”이 사업자 또는 정산 계좌를 변경할 경우 반드시 변경사항을 “회사”에게 미리 알려야 한다. 단, 이를 통지하지 않아 정산금이 오송금 되는 등의 문제가 발생할 경우 ”구장 회원”은 그에 대해 전적인 책임을 부담하며 이를 이유로 “회사”에 추가 정산 등을 요구할 수 없다.
1) “구장 회원”은 “회사”에게 정산 받은 금액에 대한 세금 신고의 의무를 부담하며, 이를 진행하지 않아 발생하는 일체의 책임은 “구장 회원”에게 있다.
1) “구장 회원”이 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 정한 손해배상, 보상액, 위약벌 등 기타 명칭을 불문하고 “회사” 또는 “이용자”에게 지급해야 할 금액이 있는 경우, “회사”는 해당 금액을 “구장 회원”에게 지급하여야 하는 본 조의 정산 금액에서 공제할 수 있다. 단, 이 때 “구장 회원”이 “이용자”에게 지급해야 하는 금액이 정산 금액에서 공제된 경우에는 “회사”가 “구장 회원”을 대신하여 해당 금액을 “이용자”에게 전달하여야 하며, “구장 회원”은 이로 인해 “이용자”에게 부담하는 손해배상액 또는 보상액 지급 채무를 면한다.
1) “회사”는 “플랩풋볼 제휴 세부 정책”에 따라 “구장 회원”에게 지급해야 하는 제1항 및 제2항의 정산 금액의 비율을 조정하거나 감액할 수 있다.

**제 9 조 (손해배상 및 보상)**
1) “구장 회원”이 제4조 내지 제6조를 비롯한 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책의 의무 및 책임을 다하지 못하여 “이용자”가 해당 구장 이용할 수 없게 되는 경우 이에 대한 손해배상으로 “회사”는 “구장 회원에게 정산금을 지급하지 않으며, 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 규정한 이용자 보상 기준에 따른 보상액을 “이용자” 및 “회사”에게 지급하여야 한다.
1) “회사” 또는 “구장 회원”이 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 정한 의무를 위반하거나 기타 고의 또는 과실로 상대방에게 손해가 발생하는 경우, 귀책 당사자는 이로 인해 상대방에게 발생한 손해 일체를 배상할 책임을 진다.
1) “구장 회원”이 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에 따른 의무를 위반하여 “회사”가 “이용자” 또는 제3자로부터 손해배상 청구 등 소송 또는 기타 방법으로 이의 제기를 받는 경우, “구장 회원”은 자신의 비용으로 “회사”를 면책시켜야 하며 “회사”가 방어할 수 있는 모든 자료 및 정보를 제공함으로써 문제의 해결에 적극 협조하여야 한다.
1) “회사”의 귀책 사유으로 인해 서비스가 중단되어 “구장 회원”에게 손해가 발생하는 경우, “회사”는 최대 금 [일백만원]의 범위 내에서 “구장 회원”에게 발생한 손해를 배상한다. 단, 이때 “구장 회원”은 발생한 손해에 대한 증빙을 “회사”에 제공하여야 한다.
1) “회사” 또는 “구장 회원”이 화재, 홍수, 전염병 등의 천재지변이나 사고 또는 정부기관의 조치 기타 사회통념상 부득이한 경우(이하 “불가항력”이라 한다)에 최선의 노력을 하였음에도 불구하고 본 약관상의 의무를 이행하지 못했다고 인정된 때에는 해당 사유로 인한 손해배상 기타 책임을 부담하지 아니하나, 그러한 경우에도 “회사” 및 “구장 회원”은 본 약관의 목적 달성을 위한 방안을 수립하기 위해 최대한 노력하여야 한다. 단, 이때 “불가항력”의 구체적인 정의 및 상황은”플랩풋볼 제휴 세부 정책” 등 관련 하위 정책에서 구체적으로 정하는 바에 따른다.

**제 10 조 (”회사”의 면책)**
1) “회사”는 “구장 회원”이 제공하는 “구장” 등 “스포츠 시설” 일체를 “이용자”에게 직접 제공하는 자가 아니며, 아래 각 호의 사항을 포함하여 “구장 회원”이 제공하는 “구장” 등 “스포츠 시설”과 관련된 문제로 인해 “이용자”와 “구장 회원” 간에 발생하는 분쟁에 대해서 책임을 부담하지 않는다. 단, “회사”가 자신의 “서비스”를 제공하는 과정에서 “회사”의 고의 또는 중대한 과실이 인정되는 경우는 그러지 아니한다.
1) “구장 회원”이 자신의 “구장” 등 “스포츠 시설”에 관하여 공지한 일정, 예약 정보, 관련자 연락처 등의 진실성, 정확성, 신뢰성 및 공시된 정보의 활용으로 인하여 야기되는 일체의 결과
1) “구장 회원”이 고의 또는 과실로 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 규정한 내용의 일부 또는 전부를 이행하지 않거나, 다르게 이행함으로 인해 발생할 수 있는 모든 결과
1) “회사”는 “회사”의 고의 또는 과실이 없는 한 다음과 같은 사항으로부터 발생하는 손해에 대하여 책임을 지지 아니한다.
1) “회사”가 본 약관 및 본 약관의 내용을 구체적으로 정하는 하위 세부 정책에서 정하는 방식으로 “서비스”의 제공을 제한 또는 중지함에 따라 발생한 손해
1) “회사”가 운영하는 “구장 관리 사이트” 등에 대한 접속 및 이용과 관련하여 “구장 회원”의 고의 또는 과실로 인하여 “구장 회원”, “이용자” 및 제3자에게 발생한 손해
1) “구장 회원”이 연락처, 전자우편 등 개인정보를 부실하게 기재하거나, 본 약관에 따라 입력하여야 하는 정보의 최신화 의무를 다하지 아니하여 “구장 회원”, “이용자” 및 “제3자에게 발생한 손해

**제 11 조 (서비스 이용 계약의 양도)**
1) “구장 회원"은 개인 사정, 경영 악화, 구장 인수 또는 이에 준하는 사유로 구장 영업이 종료되거나 타인에게 경영권이 넘어가는 경우, 구장 계약 종료일 혹은 구장 경영권이 타인에게 양도되는 날로부터 30일 이전에 “회사"에게 관련 내용을 알릴 의무가 있다.
1) 본 약관 동의에 따라 “회사”와 “구장 회원” 간에 체결된 서비스 이용 계약은 “회사”와 “구장 회원” 간의 사전 서면 합의 없이 타인에게 양도되지 않는다.

**제 12조 (서비스 이용 계약의 해지)**
1) 아래 각 호의 경우, “회사"는 “구장 회원”에게 계약 해지 통보를 할 수 있으며, 그 즉시 본 약관에 따른 서비스 이용 계약은 해지되고 “구장 회원”은 회원 자격을 상실한다.
1) “구장 회원”의 귀책으로 인해 “회사" 또는 “이용자"가 정상적으로 구장 이용 및 활용이 불가능하거나 인적, 물적 손해 등이 발생한 경우
1) “구장 회원”의 귀책으로 인해 “회사”에 [1백만원] 이상의 손해가 발생한 경우
1) “구장 회원”의 귀책으로 인해 “회사”에 금액과는 무관하게 [1개월 내 3회] 이상의 손해가 발생한 경우
1) “구장 회원”의 귀책으로 인해 “회사”에 금액과는 무관하게 [3개월 연속으로] 손해가 발생한 경우
1) “구장 회원”의 귀책으로 인해 일정 누락, 중복 예약 등의 문제가 3회 이상 발생한 경우
1) “구장 회원”의 귀책으로 인해 “이용자”들의 컴플레인이 10회 이상 발생한 경우
1) “구장 제휴 서비스 이용약관” 또는 본 정책에서 규정된 “구장 회원”의 의무를 5회 이상 위반하는 경우
1) “회사”가 약관 및 정책에 근거한 명시적인 시정 요청을 하였음에도 5회 이상 이를 거부하거나 이행하지 않는 경우
1) “구장 회원”이 “회사”와의 본 서비스 이용 계약 기간 중 타 대관 중개사이트 및 기타 “회사”가 제공하는 서비스와 동일, 혹은 유사한 서비스를 중복으로 이용하다가 “회사”에 손해 또는 어떠한 종류의 문제가 발생한 경우
1) “구장 회원”이 압류 및 가압류 등 금융기관의 거래정지, 회생 및 파산절차의 개시, 어음이나 수표의 부도, 영업정지 및 취소 등의 행정처분, 주요 자산에 대한 보전처분, 영업양도 및 합병 등으로 본 계약의 이행이 불가능하다고 “회사”가 판단하는 경우
1) “구장 회원”이 서비스 이용 계약 기간 중 계약 해지를 희망할 경우 “회사”에 위약벌을 지급하고 계약을 해지할 수 있으며, 이때 위약벌은 “회사”와의 서비스 이용계약에 따라 발생한 “구장 회원”의 직전 분기 월 평균 정산금액을 잔여 개월 수로 곱한 금액으로 하며, 직전 분기 월 평균 정산금액을 산정할 수 없는 경우에는 5백만원을 위약벌로 정한다. 단, 본조 제1항의 해지사유로 인해 “회사”가 “구장 회원”에게 계약 해지를 통보한 경우에도 “구장 회원”은 “회사”에 본항의 위약벌을 지급하여야 한다.
1) “구장 회원”이 서비스 이용 계약 기간이 종료되지 않았음에도 “회사”의 동의 없이 “구장”을 제3자에게 양도하거나 불가항력적인 이유로 “구장” 운영이 불가능하여 본 서비스 이용 계약을 해지해야 하는 경우에는 위제2항의 위약벌 지급 여부를 “회사”와 별도 합의하여야 한다.
1) 제2항에 의한 계약 해지의 효력은 “구장 회원”이 “회사”에 위약벌을 지급한 날로부터 10일 후에 발생한다.

**제 13 조 (세부 정책의 운영)**
“회사”는 아래와 같이 본 약관을 구성하는 하위 세부정책을 운영할 수 있으며, “구장 회원”은 아래 세부정책을 모두 준수하여야 한다.
1) “구장 제휴 세부 정책”
1) “구장 소셜 매치 일정 추가 및 취소 정책”
1) “구장 런드리 서비스 정책”
1) “구장 회원의 이용자 및 매니저 보상 정책”
1) “구장 정산 정책”
1) 기타 “회사”가 “서비스”를 운영하는 데 있어 필요한 내용을 규정한 정책

**제 14 조 (서비스의 일시 중단)**
1) “회사”는 통제할 수 없는 기술적 장애, 기간통신사업자 등 제3자의 귀책사유 및 천재지변, 국가비상사태 등의 사유로 인하여 “구장 관리 사이트” 등의 운영을 포함한 “서비스”의 일부 또는 전부의 제공이 불가능할 수 있으며, 이 경우 “서비스” 제공을 일시 중단할 수 있다.
1) “회사”가 본 조에 따라 “서비스”를 중단하는 경우 이러한 사실을 “회사”가 운영하는 “구장 관리 사이트” 또는 연락처, 전자우편, 카카오톡 등의 방법으로 “구장 회원”에게 공지 또는 통지한다. 단, 기술적 장애 사유 등의 경우에는 사후에 통지할 수 있다.

**제 15 조 (개인 정보)**
1) “회사”와 “구장 회원”은 업무상 취득한 개인정보를 목적 범위 외에 사용할 수 없으며, 개인정보주체의 동의 없이 외부에 유출할 수 없다.
1) "회사"는 원활한 "구장 제휴 서비스" 운영을 위해 필요하다고 판단 시 "이용자" 혹은 ”플랩 매니저” 등 필요한 인력에게 "구장 회원"이 소유하거나 운영하고 있는 "스포츠 시설"의 연락처, "구장 회원"의 개인 연락처, 혹은 "구장 회원"이 소유하거나 운영하고 있는 "스포츠 시설"의 관리 및 운영자 개인 연락처를 전달할 수 있으며, “구장 회원”은 “회사”가 해당 정보를 본 조에서 정한 범위에 한해 적법하게 사용할 수 있도록 관련자의 사전 동의를 획득하는 등 필요한 조치를 취할 의무를 부담한다.

**제 16 조 (비밀 유지)**
1) “회사”와 “구장 회원”은 다음 각 호에서 정한 정보를 제외하고 본 약관을 체결하는 과정에서 인지 또는 취득한 본 서비스 이용 계약의 조건 및 경영정보, 기술정보, 제품정보 또는 영업비밀(이하 "영업정보"라 한다)를 비밀로 유지하여야 하며, 사전 서면동의 없이 제3자에게 이를 누설 또는 공개하거나 본 약관의 목적 이외의 용도로 사용하여서는 아니 된다.
1) 본 약관 체결 이전에 이미 공지의 사실이 된 정보
1) 본 약관 체결 이후에 당사자의 귀책사유 없이 공지의 사실이 된 정보
1) 정부의 명령이나 법원의 결정 기타 당사자 일방이 통제할 수 없는 사유로 인하여 공개된 정보
1) 제1항의 의무는 본 서비스 이용 계약의 종료 후에도 존속한다.
1) 제1항의 “영업정보” 중 양 당사자 간의 합의로 이용 목적 달성 후에 반환하거나 파기하기로 한 정보가 있는 경우, “회사” 및 “구장 회원”은 이용 목적 달성 후 즉시 해당 정보를 반환 또는 파기하여야 한다.

**제 17 조 (마케팅 활용 등)**
1) “회사”는 “구장 회원”의 “구장” 및 “스포츠 시설” 등의 사진 및 기타 관련 정보(이하 “자료”라 함)를 “회사”가 제공하는 “서비스”의 홍보 및 마케팅, 그 외 “서비스”의 개선 등을 위해 “회사”의 “구장 관리 사이트” 또는 그 외의 곳에 게시하거나 기타 다른 방법으로 활용할 수 있다.
1) 본 약관에 따른 서비스 이용계약이 종료되고 “구장 회원”의 명시적인 요청이 있는 경우, “회사”는 해당 “구장 회원”의 “자료” 활용을 중단한다.

**제 18 조 (약관의 변경)**
1) “회사”는 관련 법령을 위배하지 않는 범위 내에서 본 약관을 개정할 수 있으며, 개정 내용과 적용 일자를 명시하여 “회사”가 제공하는 “구장 관리 사이트” 게시 혹은 개별 통지 등의 방법으로 그 적용일자로부터 최소 7일 전에 “구장 회원”에게 공지한다. 단, 개정 내용이 중대할 경우 약관 개정 최소 30일 전에 “구장 회원”에게 공지 혹은 통지한다.
1) “구장 회원”은 제1항에 따른 약관 개정에 동의하지 않을 경우 개정 약관 적용일 이전에 거부 의사를 표시하고 서비스 이용 계약의 해지를 요청할 수 있다. 단, 개정 약관 적용일까지 명시적인 거부 의사를 밝히지 않을 경우 변경된 약관에 동의한 것으로 간주한다.

**제 19 조 (통지)**
1) “회사”는 본 약관과 관련한 통지를 “구장 회원”이 제공한 전자우편, (휴대)전화번호, 카카오톡, “회사”의 “구장 관리 사이트” 초기 화면 등의 수단으로 할 수 있다.
1) “회사”는 “구장 회원” 전체에 대한 통지의 경우 7일 이상 “회사”가 운영하는 “구장 관리 사이트”에 게시함으로써 제1항의 통지에 갈음할 수 있다. 단, “구장 회원”의 서비스 이용과 관련하여 중대한 영향을 미치는 사항에 대하여는 제1항의 통지 수단에 따른 방법으로 통지한다.
1) “구장 회원”은 “회사”에 실제로 연락이 가능한 전자우편, (휴대)전화번호 등의 정보를 제공하고 해당 정보들을 최신으로 유지하여야 하며, “회사”가 발송하는 통지사항을 성실히 확인하여야 한다.
1) “구장 회원”이 제3항의 의무를 소홀히 하여 발생한 불이익에 대해서는 보호받지 못한다.

**제 20 조 (분쟁의 해결)**
본 약관에 따른 서비스 이용 계약과 관련하여 발생하는 모든 분쟁과 이에 따른 소송은 민사소송법상의 관할법원에서 해결한다.
`,
      },
      {
        title: "구장 제휴 세부 정책",
        content: `1. 플랩풋볼 구장 제휴 세부 정책의 목적
본 정책은 “구장 제휴 서비스 이용약관”에서 규정된 의무 및 각종 기준에 대한 세부사항을 규정하고 이를 위반할 경우 지급해야 하는 구체적인 손해배상 책정 기준 및 위약벌 기준을 정하는 데에 목적이 있다.

2. 용어
본 정책에서 별도 규정된 용어를 제외하고, 그 외의 용어는 “구장 제휴 서비스 이용약관”에서 정의된 바에 따른다.

3. “구장 회원”의 의무 및 책임
1) 안전성 및 편의성 유지 의무
“구장 회원”은 자신이 제공하는 “구장” 및 “스포츠 시설”의 구조물 및 시설물(인조 잔디, 골대, 그물 등) 일체에 대해 파손, 노후, 손상, 훼손을 방지하고 수리하여 안전성과 편의성을 유지할 의무를 부담한다. 

이때, “구장 회원”이 수리 및 보수 의무를 부담하는 파손, 노후, 손상, 훼손의 구체적인 정도 및 예시는 다음과 같다. 단, 이는 예시에 불과하며, “회사”는 “이용자”의 안전 및 원활한 “서비스” 제공을 위해 필요하다고 판단될 경우 “구장 회원”에 구조물 및 시설물의 보수 또는 수리를 요청할 수 있다.

💡보수/수리 전
인조 잔디가 찢어진 경우
골대 프레임이 휘어지는 등 구조가 불안정한 경우
골대 그물 혹은 구장 구조물을 구성하는 그물이 찢어진 경우
인조 잔디의 쿠션감이 저하된 경우
골대의 도장이 벗겨지거나 녹이 발생한 경우
구장 구조물을 구성하는 그물이 늘어지거나 탄성이 저하된 경우
인조 잔디 이음새가 벌어진 경우
골대를 고정하는 볼트가 풀리거나 부속품이 탈락한 경우
구장 구조물을 구성하는 그물 연결 고리가 풀린 경우
인조 잔디 위 경기장을 구분하는 라인이 명확하게 보이지 않는 경우
골대에 충격 자국이 발생한 경우

💡보수/수리 후
찢어진 잔디 교체 및 이음 부위 정리 완료
골대 새로 교체 혹은 보강
인조 잔디의 마모된 부분 교체, 충진재 보강
골대 재도장
골대 그물 혹은 구장 구조물을 구성하는 그물을 새 그물로 교체 혹은 재봉
인조 잔디 이음새 재접착 및 경계 정리
골대를 고정하는 볼트 재고정 및 부속품 교체
구장 구조물을 구성하는 그물 연결 재조임, 보강
인조 잔디 위 경기장을 구분하는 라인이 잘 보이도록 재시공

2) 시설물 관리 의무
“구장 회원”은 “이용자”의 원활한 “구장” 및 “스포츠 시설” 이용을 위하여 조명, 구장 시설 개폐, 쓰레기 처리 및 구장의 청결 등을 관리하여야 할 의무를 부담한다.

이때, “구장 회원”이 관리해야 하는 시설물 관리 및 청결 의무의 구체적인 정도 및 예시는 다음과 같다. 단, 이는 예시에 불과하며, “회사”는 “이용자”의 안전 및 원활한 “서비스” 제공을 위해 필요하다고 판단될 경우 “구장 회원”에 “구장” 및 “스포츠 시설”의 관리를 요청할 수 있다.

💡시설물 관리 전
일부 조명 기구가 고장 나 점등되지 않거나, 밝기가 낮고 깜빡임 발생
출입문, 천막 등 개폐 시 뻑뻑하거나 일부 작동 불량, 고정이 안 되는 부분 있음
쓰레기통이 넘쳐 있거나 악취 발생, 주변에 쓰레기 무단 투기 흔적 존재
바닥, 벤치, 화장실 등 전반적으로 먼지·오염 있음, 세면대/거울에 물때·얼룩 존재

💡시설물 관리 후
모든 조명 정상 점등 확인, 밝기 균일하게 유지되며 깜빡임 없음
출입문, 천막 등 개폐 시설 작동 원활, 레일 정비 완료, 고정 상태 안정적
쓰레기통 비움 및 세척 완료, 주변 청소 완료되어 깨끗한 상태 유지
바닥, 벤치, 화장실 등 전반적으로 청소 및 소독 완료

3) 안전 관리 의무
“구장 회원”은 “이용자”의 기상 상황으로 인한 부상을 예방하고 시설 이용에 지장이 발생하지 않도록 “구장” 및 “스포츠 시설”의 해빙, 제설, 배수, 낙상 방지 등의 작업을 수행할 의무를 부담한다.

이때, “구장 회원”이 관리해야 하는 시설물 안전 관리 의무의 구체적인 정도 및 예시는 다음과 같으며 “회사”는 “이용자”의 안전 및 원활한 “서비스” 제공을 위해 필요하다고 판단될 경우 “구장 회원”에게 안전 관리를 위한 작업을 요청할 수 있다.

💡안전 관리 전
“구장” 및 “스포츠 시설”에 얼음층이 남아 있어 미끄러질 위험이 있음
”구장” 및 “스포츠 시설”에 눈이 쌓여 이동이 불편하며 미끄러질 위험이 있음
”구장” 및 “스포츠 시설”에 비 또는 눈 녹은 물이 고여 미끄럼·침수 위험 있음
”구장” 및 “스포츠 시설”이 바닥 젖어 있어 넘어질 위험 존재

💡안전 관리 후
“구장” 및 “스포츠 시설”에 얼음층이 없고 미끄러질 위험이 없음
”구장” 및 “스포츠 시설”에 쌓인 눈이 없어 이동의 제약이 없으며 미끄러질 위험이 없음
”구장” 및 “스포츠 시설”에 비 또는 눈 녹은 물이 고이지 않아 미끄럼·침수 위험 없음
”구장” 및 “스포츠 시설”이 바닥이 젖지 않아 넘어질 위험 없음

4) 구장 사용 일정 준수 의무 
“구장 회원”은 특별한 사유 없이 “회사”와 사전 협의한 구장 사용 일정을 임의로 변경하거나 취소할 수 없으며, “소셜 매치 일정 추가 및 취소 정책”에 규정한 조건과 절차에 따를 경우 예외적으로 일정을 취소할 수 있다.  단, “구장 회원”이 “소셜 매치 일정 추가 및 취소 정책”에서 정한 절차에 따라 적법하게 일정을 취소한 경우에도 “이용자”에 대해 이용료 환불 의무 또는 보상금 지급 의무가 발생하는 경우에는 “구장 회원”은 “이용자”에게 해당 이용료를 환불하고 보상금을 지급할 의무를 부담한다. 

구장 사용 일정 취소가 승인되지 않은 경우, “구장 회원”은 기존에 협의된 구장 사용 일정에 따라 “이용자”로 하여금 “구장” 및 “스포츠 시설”을 사용할 수 있도록 하여야 한다.

5) 매치 진행 가능 여부 확인 의무
“구장 회원”은 “회사”가 요청하는 매치 진행 가능 여부 확인에 대해 “회사”가 지정하는 방법으로 정해진 시간 내 응답해야 한다. 응답이 없을 경우 “회사”는 매치를 취소할 수 있으며, “회사”가 정해진 시간 내 응답하지 않아 손해가 발생한 때에는 “구장 회원”은 그 손해에 대한 배상 책임을 부담한다.

6) 기상 상황에 따른 구장 관리 의무
강수 등 기상 상황으로 인해 구장 상태 불량 또는 관리 소홀로 매치가 취소된 경우, “회사”는 다음 각 항의 어느 하나에 해당할 때 “구장 회원”에 손해배상을 청구할 수 있다. 손해 배상액은 실제 참가 인원 기준으로 산정하며, 1인당 참가비의 최대 200% 범위 내에서 결정된다.

“회사”가 공지한 매치 진행 가능 기준을 위반한 경우
“회사”의 매치 진행 가능 여부 확인 요청에 응답하지 않은 경우
그 밖의 “회사”와 “구장 회원”이 책임을 인정한 경우

4. 평가 결과 및 패널티
1) 평가 결과
회사는 “이용자”의 “구장” 및 “스포츠 시설” 평가에 따라 우수, 보통, 주의 3단계 기준으로 “구장 회원”을 평가할 수 있다. 평가는 매일 자정 업데이트되며, 최근 3개월 간의 데이터를 기준으로 갱신된다.

우수 : 고객 만족도 90% 이상
보통 : 고객 만족도 60% 이상 90% 미만
주의 : 고객 만족도 60% 미만
2) 패널티 
“회사”는 서비스 운영 기준 및 평가 결과에 따라 “구장 회원”의 “구장”이 ‘주의’ 평가를 받은 경우, 해당 구장에 대해 시정 요청을 할 수 있으며, 시정 요청 누적 횟수에 따라 아래와 같은 패널티를 부과할 수 있다.

시정 요청 1회
“주의” 평가를 받은 구장에 대해, 문제 사항에 대한 개선 요청이 서면(전자적 방식 포함)으로 전달된다.

시정 요청 3회 이상 누적 시
동일 구장이 “주의” 평가를 받고 시정 요청이 3회 이상 누적된 경우, “회사”는 해당 “구장 회원”의 매치 일정을 일시적으로 제외 또는 정지할 수 있다.

시정 요청 5회 이상 누적 시
“주의” 평가를 받은 구장에 대해 시정 요청이 5회 이상 누적되었음에도 개선되지 않은 경우, “회사”는 “구장 제휴 서비스 이용약관”에 따라 해당 “구장 회원”과의 서비스 이용계약을 해지하거나 위약벌을 청구할 수 있다.
`,
      },
      { title: "구장 소셜 매치 일정 추가 및 취소 정책", content: `1. 목적
본 정책은 “구장 제휴 서비스 이용약관”에서 규정된 내용 중 “구장 회원”이 “소셜 매치 진행 서비스”를 이용하는 과정에서 소셜 매치 일정 추가 및 취소, 변경 등의 기준 및 절차를 정하는 데에 그 목적이 있다.
본 정책에서 규정한 내용 외에는 “플랩풋볼 이용 가이드”에 정한 바에 따른다.
2. 용어
본 정책에서 별도 규정된 용어를 제외하고, 그 외의 용어는 “구장 제휴 서비스 이용약관”에서 정의된 바에 따른다.
정기 일정: 매주 같은 요일 및 시간에 반복되는 일정
개별 일정: 정기적인 일정이 아닌 단발성 매치 일정
3. 일정 추가
1) “구장 회원”의 일정 추가 기준
“구장 회원”은 “회사”가 제공하는 “구장 관리 사이트” 내 [소셜 매치 추가/변경/취소] 페이지를 통해 소셜 매치 진행이 가능한 일정을 추가함으로써 일정 추가를 요청할 수 있다. 이때, “회사”는 내부 수요/공급 데이터를 바탕으로 설계된 시스템을 통해 조건에 맞게 자동으로 일정 추가 요청을 승인 또는 반려할 수 있다.
“구장 회원”의 면(구역) 별 평일 프라임 정기 일정 수에 따라 요청 가능한 일정이 제한되며 평일 프라임 타임이란 월요일부터 금요일까지의 평일 중 19:00~21:59 사이에 시작하는 일정을 뜻한다.
요일과 시간에 따른 타임 분류
[[TIMETABLE]]
2) 정기 일정 추가
정기 일정이란, 매주 같은 요일 및 시간에 반복되는 일정을 말한다.
정기 일정의 경우 희망하는 구장, 면(구역), 요일, 시간, 희망 시작일을 입력하여 추가 요청할 수 있으며 시스템 조건에 맞게 자동 승인 또는 반려 처리된다.
3) 개별 일정 추가
개별 일정이란, 정기적인 일정이 아닌 단발성 매치를 말한다.
개별 일정의 경우, 희망하는 구장, 면(구역), 요일, 시간, 희망 시작일을 입력하여 추가 요청할 수 있으며 시스템 조건에 맞게 자동 승인 또는 반려 처리된다.
4. 매치 공개 기준
1) 매치 공개
“구장 관리 사이트”에 매치가 공개되어 모집을 시작하려면 반드시 “매니저”가 배정되어야 한다. 매치는 기본적으로 대기 상태로 등록되며, 이때는 홈페이지에 노출되지 않는다. 이후 “매니저”가 배정되면 자동으로 매치 리스트에 공개된다.
2) 매니저 배정
“구장 회원”이 요청한 일정에 직접 “매니저” 배정을 희망하는 경우 “매니저”가 직접 매니저 앱을 통해 신청해야 한다. “구장 회원”이 직접 “매니저” 배정이 불가능할 경우, “구장 회원”이 등록한 대기 상태의 매치에 “매니저”가 직접 신청하여 “매니저”가 매칭될 수 있다.
5. 일정 취소
1) 원칙
“구장 회원”은 매니저가 배정되어 공개된 일정에 대해 취소할 수 없다. 다만 불가피한 사유로 공개된 일정의 취소가 필요한 경우, “구장 회원”은 이를 증빙할 수 있는 자료와 함께 “회사”에 일정 취소를 요청할 경우에 한해 일정 취소가 가능하다. 이때, 불가피한 사유란 다음과 같다.
자연재해, 국가적 재난 상황, 정부/지자체의 지시 등의 천재지변 및 불가항력
천장 누수, 조명 고장, 보수 공사 등의 시설 문제
기타 상기 사유에 준하는 불가피한 사유라고 “회사”가 판단하는 경우
이외 “구장 회원”의 개인적인 사정으로 일정을 취소할 경우, “이용자 및 매니저 보상 정책” 및 아래 “4) 일정 취소 시 위약금 발생 기준”에 따라 위약금이 부과될 수 있다.
2) 정기 일정 취소
공개된 정기 일정은 취소가 불가능하다. 단, 최근 8주 동안 5개 이상의 매치가 진행되지 않은 부진 정기 일정은 익월 1일에 정기 일정에서 자동 제외되고, 이미 공개되어 있는 매치 일정은 유지되며, 익월부터 매치 세팅에서 제외된다.
3) 개별 일정 취소
공개된 개별 일정은 취소가 불가능하다. 단, 매니저가 배정되지 않아 대기 상태인 일정의 경우 “구장 회원”이 구장 관리 사이트에서 직접 취소가 가능하다.
4) 일정 취소 시 위약금 발생 기준
위약금 공제 방법
“구장 회원”이 정당한 사유 없이 일정을 취소할 경우 위약금이 발생한다.
“회사”는 해당 위약금을 “구장 회원”에게 지급하여야 하는 정산금에서 공제할 수 있다. 만약 “회사”가 “구장 회원”에게 지급하여야 하는 정산금이 없거나 “구장 회원”으로부터 지급받아야 하는 위약금이 “구장 회원”에게 지급하여야 하는 정산금보다 큰 경우에는, 정산금에서 공제되지 않은 위약금을 다음 회차 정산 시 공제할 수 있다.
위약금 발생 기준
일정
위약금 발생 기준
비고
정기 일정
- 정기 일정 당 400,000원
단, 해당 정기 일정이 첫 세팅된 날로부터 3개월이 유지된 경우 위약금 없이 취소가 가능하다.
개별 일정
- 구장 사용 예정일로부터 14일 이상 : 10,000원
- 구장 사용 예정일로부터 13일 이내 : 30,000원
- 구장 사용 예정일 당일 : 50,000원
6. 면(구역) 변경
면(구역) 변경의 경우, 동일한 요일, 동일한 시간, 동일한 매치 플레이어 수(5vs5, 6vs6)인 경우만 가능하며, 면(구역) 변경 가능 조건에 부합할 경우 자동으로 승인 처리된다.
기존 일자와 변경 희망 일자가 다르거나, 기존 시간과 변경 희망 시간이 다르거나, 기존 면(구역)의 규격 및 상태와 변경 희망 면(구역)의 규격 및 상태가 다른 경우에는 변경이 불가능하며, 매치 취소 요청 후 추가를 요청하여야 한다.
또한, 변경 요청한 면(구역)의 구장 만족도 점수가 기존 면(구역)보다 10% 이상 낮거나 진행 히스토리가 없는 면으로 요청하는 경우에 해당 변경 요청은 반려될 수 있다.
1) 정기 일정의 면 변경
정기 일정의 경우, “구장 관리 사이트” 내 정기 일정의 면 변경 정책과 가이드를 따른다.
2) 개별 일정의 면 변경
개별 일정의 경우, “구장 관리 사이트” 내 개별 일정의 면 변경 정책과 가이드를 따른다.` },
      { title: "구장 회원의 이용자 및 매니저 보상 정책", content: `1. 목적
본 정책은 “구장 제휴 서비스 이용약관”에서 규정된 내용 중 “이용자” 및 “매니저”에 대한 “구장 회원”의 보상 의무 및 그 구체적인 기준을 정하는 데에 그 목적이 있다.
2. 용어
본 정책에서 별도 규정된 용어를 제외하고, 그 외의 용어는 “구장 제휴 서비스 이용약관”에서 정의된 바에 따른다.
3. “이용자”에 대한 보상
“이용자”는 사전에 신청한 일정에 따라 “구장 회원”의 “구장” 또는 “스포츠 시설”을 원활하게 이용할 권리가 있다.
“구장 회원”의 귀책으로 인해 예약된 일정에 “구장” 또는 “스포츠 시설”을 이용하지 못하거나 정상 매치가 불가능한 경우, 아래와 같은 기준에 따라 정산금 일부를 차감하고 잔여 금액에 대해 “구장 회원”에게 한다.
1) 구장 예약
“구장 예약 서비스” 와 관련하여 “회사”는 “구장 회원”이 등록한 일정 정보를 “이용자”에게 노출하고, “이용자”가 해당 일정에 대해 예약 및 결제를 진행할 수 있도록 중개하는 역할만을 수행한다.
“회사”는 단순 중개자로서, “구장 회원”과 “이용자” 간 체결되는 “구장 예약 서비스” 이용 계약의 직접 당사자가 아니며, 해당 계약의 이행, 변경, 해지, 환불, 보상 등에 대해 책임을 지지 않는다.
“구장 회원”은 본인의 귀책 사유(예: 시설 문제, 인력 미배치, 운영 중단 등)로 인해 예약된 일정이 정상적으로 진행되지 못하는 경우, 그로 인해 발생한 “이용자”의 피해에 대해 직접 책임지고 협의·조치해야 하며, “회사”는 이에 대한 금전적 또는 법적 책임을 지지 않는다.
2) 소셜 매치 / 팀 리그
[[USAGE_TABLE]]
위 기준에 따라 정산금 일부가 차감된 후 정산되며 다음 특수 상황 발생 시 처리 기준은 아래와 같다.“구장 회원”의 과실(구장 상태 불량, 관리 소홀, 중복 대관 등)로 정상적인 구장 이용 불가 시구장 사용 시간과 상관없이 구장 정산금 미정산 처리
“이용자”의 참가비 최대 200%에 해당하는 금액을 구장에 청구 (”이용자” 보상용)
“매니저”에 대한 인건비 별도 청구
“구장 회원”의 과실(구장 상태 불량, 관리 소홀, 중복 대관 등)로 미니 게임 진행 시구장 정산금의 50%만 정산 처리
3) 구장 등 시설물의 문제로 인해 이용자에게 손해가 발생하는 경우
“구장 회원”은 자신이 운영·관리하는 “구장” 또는 그 시설물의 하자로 인해 “이용자”에게 손해가 발생하는 상황에 대비하여, 적절한 범위의 시설물 관련 보험에 가입하여야 한다.
“이용자”가 “구장 회원”의 “구장”에서 서비스를 이용하는 과정에서 “구장” 또는 시설물의 하자로 인해 부상 등 손해를 입은 경우, “구장 회원”은 가입한 보험을 통해 “이용자”에게 발생한 손해를 배상하여야 한다.
“구장 회원”이 보험에 가입하지 않았거나, 가입한 보험으로는 해당 손해에 대한 배상이 불가능한 경우라 하더라도, “구장 회원”의 시설물 관리 책임이 인정되는 경우에는 “회사”가 “구장 회원”을 대신하여 “이용자”에게 합리적인 수준의 배상금을 지급할 수 있다.
이 경우 “구장 회원”은 “회사”가 “이용자”에게 지급한 배상금 전액 및 그로 인해 “회사”가 입은 손해(이미지 실추 및 명예훼손 등으로 인한 손해 및 법률비용 등을 포함하며 이에 한정되지 아니한다)를 “회사”에 배상하여야 합니다.
4) 보상금 지급 예외 사항
“구장 회원”은 아래와 같은 불가피한 사유가 인정되는 경우에 한하여, 이를 증빙할 수 있는 자료를 첨부하여 “회사”에 제출하는 경우 보상금 지급 의무가 면제될 수 있다.
자연재해, 국가적 재난 상황, 정부/지자체의 지시 등의 천재지변 및 불가항력
기타 상기 사유에 준하는 불가피한 사유라고 “회사”가 판단하는 경우
4. “매니저”에 대한 보상
“구장 회원”의 귀책으로 인해 예약된 일정에 “구장” 또는 “스포츠 시설”을 이용하지 못하거나 정상 매치가 불가능한 경우, “구장 회원”은 “매니저”에게 아래와 같은 기준에 따라 정산금 일부를 차감하거나 해당하는 금액을 반환하여야 한다.
1) 구장 사용 예정일에 구장을 이용하지 못한 경우
[[CANCEL_TABLE]]
2) 구장을 이용했으나, 정상적으로 매치가 진행되지 않은 경우
매니저가 구장에 도착했지만 현장에서 정상적으로 매치가 진행되지 않은 경우 경기 미진행 시간과 상관없이 아래 보상금 기준을 따른다.
[[MATCH_TABLE]]
3) 보상금 지급 예외 사항
“구장 회원”은 아래와 같은 불가피한 사유가 인정되는 경우에 한하여, 이를 증빙할 수 있는 자료를 첨부하여 “회사”에 제출하는 경우 보상금 지급 의무가 면제될 수 있다.
자연재해, 국가적 재난 상황, 정부/지자체의 지시 등의 천재지변 및 불가항력
기타 상기 사유에 준하는 불가피한 사유라고 “회사”가 판단하는 경우
5. 보상금 지급 방식
“구장 회원”이 본 정책에 따라 자신의 귀책으로 “이용자” 혹은 “매니저”에게 보상금을 지급해야 하는 경우, 해당 보상금은 반드시 “회사”를 통하여 지급되어야 한다.
“구장 회원”은 “회사”에 보상금을 지급함으로써 “이용자”에 대한 보상금 지급 채무를 면한다. 이 때, “회사”는 “구장 회원”으로부터 직접 보상금을 지급받는 대신 “구장 회원”에게 지급하여야 하는 정산금에서 보상금을 공제하고 지급할 수 있으며, 차감할 정산금이 없는 경우에는 다음 회차의 정산금에서 공제할 수 있다.` },
      { title: "구장 런드리 서비스 정책", content: `1. 런드리 서비스 정책의 목적
본 정책은 “구장 제휴 서비스 이용약관”에서 규정된 내용 중 “런드리 서비스”에 대한 구체적인 사항과 “회사”와 “구장 회원” 간 권리 및 의무에 관한 사항을 정하는 데에 목적이 있다.
2. 용어
본 정책에서 별도 규정된 용어를 제외하고, 그 외의 용어는 “구장 제휴 서비스 이용약관”에서 정의된 바에 따른다.
런드리 서비스 : 소셜 매치 진행에 필요한 조끼와 공과 같은 장비를 구장에 비치하여, 매니저들이 더욱 간편하게 소셜 매치를 운영할 수 있도록 지원하는 서비스를 말한다.
장비 : 장비란 “회사”가 “구장 회원”에게 무상으로 지원한 조끼, 공 등의 장비 일체를 말한다.
3. 당사자의 역할 및 책임
“구장 회원”은 “회사”가 지원하는 “장비”를 안전하게 보관하고, “장비” 사용 후 세탁 및 유지 관리에 대한 책임을 부담한다.
“회사”는 조끼, 공과 같은 “장비”를 “구장 회원”에게 무상으로 지원하며, “런드리 서비스”의 원활한 운영을 위한 전반적인 지원과 관리를 수행한다.
4. 런드리 서비스 운영 정책
1) “장비” 관리 정책
“구장 회원”은 “장비”를 분실할 경우 매치 운영에 차질이 발생하지 않도록 그 즉시 “추가 장비 신청서”를 작성하여 “회사”에 제출하는 방법으로 신속하게 “장비”를 신청하여야 한다.
“구장 회원”은 “장비”에 오염 또는 훼손이 발생할 경우, “장비”를 세탁 또는 수리하여 원상태로 복구하여야 하며, 세탁 또는 수리가 어려울 경우 매치 운영에 차질이 발생하지 않도록 “추가 장비 신청서”를 작성하여 “회사”에 제출하는 방법으로 신속하게 “장비”를 신청하여야 한다.
“구장 회원”은 지원 받은 “장비”를 안전하게 보관할 수 있는 적절한 공간을 제공하여야 하며, “장비” 보관 공간의 청결과 안전을 유지하여 “장비”의 손상을 방지하여야 한다.
2) 서비스 변경 및 협의
“구장 회원”은 “런드리 서비스” 이용 또는 “구장 제휴 서비스”와 관련하여 중대한 변경이 있을 경우, 최소 14일 전에 “회사”와 이에 대한 사전 협의를 진행하여야 한다. 부득이한 사유로 인해 “런드리 서비스” 운영을 임시 중단해야 하는 경우, “구장 회원”은 사전에 “회사”에 통지 하여 임시 중단 프로세스를 이행하여야 한다.
3) 서비스 운영 책임
“런드리 서비스”가 정상적으로 운영되지 않거나 “장비”의 보관 또는 세탁 등의 관리 소홀로 인해 매치 운영에 지장이 발생한 경우, “구장 회원”과 “회사”는 원인 조사를 통해 책임 소재를 명확히 파악하고 이에 따른 조치를 취해야 한다.
“구장 회원”의 귀책으로 인해 “런드리 서비스”가 정상적으로 운영되지 않아 매치 운영에 지장이 발생한 경우 “회사”는 “구장 회원”에 기한을 정해 시정 및 개선을 요청할 수 있다. “회사”는 필요 시 “런드리 서비스” 또는 “구장 제휴 서비스”를 일시 중단할 수 있다.
“회사”의 귀책으로 인해 “런드리 서비스”가 정상적으로 운영되지 않아 매치 운영에 지장이 발생한 경우 “회사”는 정상적인 매치 운영에 필요한 후속 지원을 제공한다.
4) 손해배상 기준
“런드리 서비스”가 정상적으로 운영되지 않거나 “장비”의 보관 또는 세탁 등의 관리 소홀로 인해 금전적 손실이나 “이용자”의 민원, 매치 지연 또는 취소 등의 피해가 발생하는 경우, 책임 소재에 따라 귀책사유 있는 당사자가 상대방에게 손해배상금을 지급하여야 한다.
“구장 회원”의 귀책으로 인한 경우에는 “구장 회원”이 “회사”에 이로 인해 발생한 손해액을 배상하여야 하며, 이와 같은 상황이 반복적으로 발생할 경우 “회사”는 “구장 회원”과의 “구장 제휴 서비스” 계약 조건을 조정하거나 계약을 해지할 수 있다.
“회사”의 귀책으로 인한 경우에는 “회사”가 “구장 회원”에 이로 인해 발생한 손해액을 배상하여야 하며, 재발방지를 위한 내부 개선 조치를 시행한다.
손해배상 금액은 실질적으로 발생한 손해액을 기준으로 하되, 당사자 간 사전 협의 및 상호 조율을 원칙으로 한다.
5. 런드리 서비스 계약 해지
“구장 회원”이 반복적으로 본 정책을 위반할 경우, “회사”는 단계별로 아래와 같은 조치를 취할 수 있다.
1차 위반 : “구장 회원”이 본 정책을 1회 위반할 경우, “회사”는 “구장 회원”에게 구두 또는 서면 경고를 실시한다.
2차 위반 : “구장 회원”이 본 정책을 2회 위반할 경우, “회사”는 “구장 회원”에게 재발방지를 위한 시정 요청과 함께 일정 기간동안 집중 모니터링을 실시하며, 필요 시 재발방지를 위한 추가 협의를 진행한다.
3차 위반 : “구장 회원”이 본 정책을 3회 위반할 경우, “회사”는 “구장 회원”과의 “런드리 서비스” 또는 “구장 제휴 서비스” 일시 중단 또는 “구장 회원”과의 계약 조건을 조정할 수 있다.
그 이상 위반 : “구장 회원” 이 본 정책을 3회 초과하여 위반할 경우, “회사”는 “구장 회원”과의 “구장 제휴 서비스” 계약을 해지할 수 있다.
6. 장비 반납 정책
“런드리 서비스”가 중단되거나 “구장 제휴 서비스” 계약이 해지되는 경우, “구장 회원”은 “회사”가 제공한 “장비” 일체를 서비스 중단일 또는 계약 해지일로부터 14일 이내에 반납하여야 한다.
”구장 회원”이 ”장비”를 반납하지 않을 경우, 미반납된 “장비”에 대해서는 다음의 단가를 적용하여 정산 금액에서 차감될 수 있다. 단, 정상적인 운영 과정에서 발생한 “장비”의 분실, 파손, 노후화 등은 감안하여 정산 시 반영할 수 있다.
조끼 1장 : 3,500원
공 1개 : 30,000원
“구장 회원”이 “장비”를 반납할 시에는 “회사”에서 제공하는 반납 가이드를 기준으로 절차를 이행하여야 하며, 반납이 지연되거나 “회사”의 반납 가이드를 따르지 않을 경우, 정산 차감 등의 조치가 취해질 수 있다.` },
    ],
    [],
  );

  const renderMarkdown = (text: string) => {
    const lines = text.replace(/\r\n/g, "\n").split("\n");
    let html = "";
    let inTipBox = false;
    let indentAfterNumber = false;
    let lastWasHeading = false;
    let inNumberBlock = false;
    let numberCounter = 1;
    const timeTableHtml = `
      <div class="mt-2 mb-3 overflow-x-auto">
        <table class="w-full min-w-[520px] border border-[#E3E6EC] text-sm">
          <thead class="bg-[#F9FAFB]">
            <tr>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">평일(월/화/수/목/금) 타임 분류</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">시작 시간 기준</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">주말(토/일) 타임 분류</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">시작 시간 기준</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">비프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">09:00~17:59</td>
              <td class="border border-[#E3E6EC] px-3 py-2">오전</td>
              <td class="border border-[#E3E6EC] px-3 py-2">09:00~12:59</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">준프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">18:00~18:59</td>
              <td class="border border-[#E3E6EC] px-3 py-2">오후</td>
              <td class="border border-[#E3E6EC] px-3 py-2">13:00~18:59</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">19:00~21:59</td>
              <td class="border border-[#E3E6EC] px-3 py-2">프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">19:00~21:59</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">준프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">22:00~22:59</td>
              <td class="border border-[#E3E6EC] px-3 py-2">준프라임</td>
              <td class="border border-[#E3E6EC] px-3 py-2">22:00~22:59</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">심야</td>
              <td class="border border-[#E3E6EC] px-3 py-2">23:00~24:00</td>
              <td class="border border-[#E3E6EC] px-3 py-2">심야</td>
              <td class="border border-[#E3E6EC] px-3 py-2">23:00~24:00</td>
            </tr>
          </tbody>
        </table>
      </div>
    `;

    const usageTableHtml = `
      <div class="mt-2 mb-3 overflow-x-auto">
        <table class="min-w-[280px] border border-[#E3E6EC] text-sm">
          <thead class="bg-[#F9FAFB]">
            <tr>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">구장 사용 시간</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">정산금 차감 비율</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">~30분</td>
              <td class="border border-[#E3E6EC] px-3 py-2">75%</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">31분~60분</td>
              <td class="border border-[#E3E6EC] px-3 py-2">50%</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">61분~90분</td>
              <td class="border border-[#E3E6EC] px-3 py-2">25%</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">91분~</td>
              <td class="border border-[#E3E6EC] px-3 py-2">0%</td>
            </tr>
          </tbody>
        </table>
      </div>
    `;

    const cancelTableHtml = `
      <div class="mt-2 mb-3 overflow-x-auto">
        <table class="w-full min-w-[420px] border border-[#E3E6EC] text-sm">
          <thead class="bg-[#F9FAFB]">
            <tr>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">일정 취소 시점</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">보상금 기준</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">구장 사용 예정일로부터 14일 이상</td>
              <td class="border border-[#E3E6EC] px-3 py-2">2,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">구장 사용 예정일로부터 13일 이내</td>
              <td class="border border-[#E3E6EC] px-3 py-2">5,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">구장 사용 예정일 당일</td>
              <td class="border border-[#E3E6EC] px-3 py-2">10,000원</td>
            </tr>
          </tbody>
        </table>
      </div>
    `;

    const matchTableHtml = `
      <div class="mt-2 mb-3 overflow-x-auto">
        <table class="w-full min-w-[420px] border border-[#E3E6EC] text-sm">
          <thead class="bg-[#F9FAFB]">
            <tr>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">매치 분류</th>
              <th class="border border-[#E3E6EC] px-3 py-2 text-left font-semibold">보상금 기준</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">일반 소셜 매치</td>
              <td class="border border-[#E3E6EC] px-3 py-2">25,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">팀 리그</td>
              <td class="border border-[#E3E6EC] px-3 py-2">35,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">8vs8 축구 매치</td>
              <td class="border border-[#E3E6EC] px-3 py-2">35,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">11vs11 축구 매치</td>
              <td class="border border-[#E3E6EC] px-3 py-2">40,000원</td>
            </tr>
            <tr>
              <td class="border border-[#E3E6EC] px-3 py-2">컴팩트 매치</td>
              <td class="border border-[#E3E6EC] px-3 py-2">15,000원</td>
            </tr>
          </tbody>
        </table>
      </div>
    `;

    const formatInline = (value: string) => value.replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>");
    const normalizeContent = (value: string) => value.replace(/(\d+)\)/g, "$1.");

    for (const line of lines) {
      const trimmed = line.trimStart();
      const normalized = normalizeContent(trimmed);
      const isTip = normalized.startsWith("💡");
      const isHeading = /^#/.test(normalized) || normalized.startsWith("**제");
      const isNumbered = /^\d+\./.test(normalized);

      if (isTip) {
        if (inTipBox) {
          html += "</div>";
        }
        inTipBox = true;
        indentAfterNumber = false;
        inNumberBlock = false;
        html += `<div class="mt-2 mb-3 rounded-lg border border-[#E3E6EC] bg-[#F9FAFB] px-3 py-2">`;
        html += `<div class="text-sm font-semibold text-[#111827]">${formatInline(trimmed)}</div>`;
        continue;
      }

      if (normalized === "") {
        if (!lastWasHeading) {
          html += "<br />";
        }
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        inNumberBlock = false;
        continue;
      }

      if (normalized === "[[TIMETABLE]]") {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        html += indentAfterNumber ? `<div class="ml-7">${timeTableHtml}</div>` : timeTableHtml;
        continue;
      }

      if (normalized === "[[USAGE_TABLE]]") {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        html += indentAfterNumber ? `<div class="ml-7">${usageTableHtml}</div>` : usageTableHtml;
        continue;
      }

      if (normalized === "[[CANCEL_TABLE]]") {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        html += indentAfterNumber ? `<div class="ml-7">${cancelTableHtml}</div>` : cancelTableHtml;
        continue;
      }

      if (normalized === "[[MATCH_TABLE]]") {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        html += indentAfterNumber ? `<div class="ml-7">${matchTableHtml}</div>` : matchTableHtml;
        continue;
      }

      if (isHeading) {
        indentAfterNumber = false;
        inNumberBlock = false;
        lastWasHeading = false;
      }

      if (isNumbered) {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        if (!inNumberBlock) {
          numberCounter = 1;
          inNumberBlock = true;
        }
        const lineText = normalized.replace(/^\d+\.\s*/, "");
        const content = `<strong>${numberCounter}. ${formatInline(lineText)}</strong>`;
        html += inTipBox ? `<div class="ml-4">${content}</div>` : `<div class="ml-5">${content}</div>`;
        indentAfterNumber = true;
        lastWasHeading = false;
        numberCounter += 1;
        continue;
      }

      if (/^\d+\./.test(normalized)) {
        if (inTipBox) {
          html += "</div>";
          inTipBox = false;
        }
        const content = `<strong>${formatInline(normalized)}</strong>`;
        if (inTipBox) {
          html += `<div class="ml-4">${content}</div>`;
        } else {
          html += `${content}<br />`;
        }
        indentAfterNumber = false;
        lastWasHeading = true;
        continue;
      }

      const formatted = formatInline(normalized);
      if (inTipBox) {
        html += indentAfterNumber ? `<div class="ml-8">${formatted}</div>` : `<div class="ml-4">${formatted}</div>`;
      } else {
        html += indentAfterNumber ? `<div class="ml-7">${formatted}</div>` : `${formatted}<br />`;
      }
      lastWasHeading = false;
    }

    if (inTipBox) html += "</div>";
    return { __html: html };
  };

  const approve = async () => {
    if (!id) return;
    setError(null);
    setBanner(null);
    try {
      const res = await fetch(`/api/onboarding/${id}/step1`, {
        method: "PATCH",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ action: "approve" }),
      });
      const json = await res.json();
      if (!res.ok) throw new Error(json?.error || "승인 실패");
      setBanner("정산안을 승인했습니다.");
      setInfo((prev) => (prev ? { ...prev, step_status: json.step_status as OnboardingState } : prev));
      // 승인 후 바로 다음 단계로 이동
      if (json.step_status === "step1_pending") {
        router.replace(`/onboarding/${id}/step2`);
      }
    } catch (e: any) {
      setError(e.message ?? "오류가 발생했습니다.");
    }
  };

  // ESC로 모달 닫기
  useEffect(() => {
    const onKey = (e: KeyboardEvent) => {
      if (e.key === "Escape") setPreview(null);
    };
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, []);

  if (loading) return <div className="p-6 text-sm">불러오는 중…</div>;
  if (!id) return <div className="p-6 text-sm text-red-600">유효하지 않은 경로입니다.</div>;

  return (
    <main className="min-h-screen bg-[#F7F9FC] px-4 py-8">
      <div className="max-w-5xl mx-auto space-y-4">
        <header className="bg-white border border-[#E3E6EC] rounded-xl shadow-sm p-6 space-y-2">
          <div className="flex items-center justify-between gap-4">
            <h1 className="text-xl font-semibold text-[#111827]">2. 정산안 확인</h1>
            <Link
              href="/"
              className="inline-flex items-center px-3 py-1.5 rounded-lg border border-[#E3E6EC] text-sm font-semibold text-[#374151]"
            >
              로그아웃
            </Link>
          </div>
          {info && (
            <div className="text-xs text-[#6b7280]">
              현재 상태: <span className="text-[#1C5DFF] font-semibold">전화 안내 완료</span>
            </div>
          )}
          {statusMessage && <div className="bg-blue-50 text-[#1C5DFF] text-sm px-3 py-2 rounded-lg">{statusMessage}</div>}
        </header>

        {banner && <div className="bg-green-100 text-green-800 px-4 py-3 rounded-lg text-sm">{banner}</div>}
        {error && <div className="bg-red-100 text-red-800 px-4 py-3 rounded-lg text-sm">{error}</div>}

        <section className="bg-white border border-[#E3E6EC] rounded-xl shadow-sm p-6 space-y-4">
          <p className="text-sm text-[#4b5563]">담당자가 업로드한 정산안을 확인한 뒤 승인 버튼을 눌러주세요.</p>
          {proposals.length === 0 ? (
            <div className="text-sm text-[#6b7280]">아직 제안된 정산안이 없습니다.</div>
          ) : (
            <div className="space-y-4">
              {proposals.map((p, idx) => (
                <div key={p.id} className="border border-[#E3E6EC] rounded-lg p-4 space-y-2 bg-[#F9FAFB]">
                  <div className="flex items-center justify-between text-sm">
                    <div className="font-semibold text-[#111827]">
                      {p.title} {idx === 0 && <span className="text-xs text-[#1C5DFF] ml-2">최신</span>}
                    </div>
                  </div>
                  {p.description && <div className="text-sm text-[#374151]">{p.description}</div>}
                  {Array.isArray(p.image_urls) && p.image_urls.length > 0 && (
                    <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                      {p.image_urls.map((url, i) => (
                        <button
                          type="button"
                          key={i}
                          onClick={() => setPreview(url)}
                          className="block border border-[#E3E6EC] rounded-lg overflow-hidden"
                        >
                          <Image src={url} alt="settlement" width={300} height={200} className="w-full h-32 object-cover" />
                        </button>
                      ))}
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
          <div className="flex justify-end gap-2">
            <button
              type="button"
              onClick={approve}
              disabled={info?.step_status !== "step3_proposed"}
              className="px-4 py-2 rounded-lg text-white font-semibold"
              style={{ background: info?.step_status === "step3_proposed" ? "#1C5DFF" : "#9CA3AF" }}
            >
              {info?.step_status === "step1_pending" ? "승인 완료" : "정산안 승인"}
            </button>
          </div>
        </section>

        <section className="bg-white border border-[#E3E6EC] rounded-xl shadow-sm p-6 space-y-4">
          <h2 className="text-sm font-semibold text-[#111827]">약관 확인</h2>
          <div className="space-y-2">
            {terms.map((term, idx) => {
              const isOpen = openTermIndex === idx;
              return (
                <div key={term.title} className="border border-[#E3E6EC] rounded-lg">
                  <button
                    type="button"
                    onClick={() => setOpenTermIndex(isOpen ? null : idx)}
                    className="w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold text-[#111827] hover:bg-[#F9FAFB]"
                  >
                    <span>{term.title}</span>
                    <span className="text-xs text-[#6b7280]">{isOpen ? "▾" : "▸"}</span>
                  </button>
                  {isOpen && (
                    <div className="px-4 pb-4 text-sm text-[#374151] leading-6">
                      <div dangerouslySetInnerHTML={renderMarkdown(term.content)} />
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        </section>

        <nav className="flex items-center justify-end">
          {showNext ? (
            <Link href={nextPath || "#"} className="px-4 py-2 rounded-lg text-white font-semibold" style={{ background: "#1C5DFF" }}>
              다음 단계로 이동
            </Link>
          ) : (
            <button className="px-4 py-2 rounded-lg border border-[#E3E6EC] text-[#6b7280]" disabled>
              다음 단계 준비 중
            </button>
          )}
        </nav>
      </div>

      {preview && (
        <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 px-4">
          <div className="relative bg-white p-2 rounded-lg max-w-6xl max-h-[90vh]">
            <button
              type="button"
              className="absolute -top-10 right-0 text-white text-sm underline"
              onClick={() => setPreview(null)}
            >
              닫기
            </button>
            <Image src={preview} alt="settlement-preview" width={2000} height={1400} className="max-h-[80vh] w-auto object-contain" />
          </div>
        </div>
      )}
    </main>
  );
}
